---
title: "Relationship between nutritional content and recipe ratings"
author: "Evelin Haasz"
format: html
---
```{r setup}
library(tidyverse)
```

## Introduction
Online recipe platforms collect and provide various different types of data about recipes and their different parameters. One commonly used indicator of recipe quality is the rating of users. At the same time there might be other parameters, such as nutritional values, that can influence how appealing a recipe is perceived.

The aim of this project is to exmaine whether there is an association between the caloric content of recipes and their average user ratings using the data from the TidyTuesday package. Specifically, the hypothesis that recipes with higher calories recieive higher agerage user ratings.

## Data

The data used for analyses comes from the TidyTuesday dataset published on 2025-09-16, which containes information about recipes sourced from Allrecipes.

```{r}
all_recipes_o <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-16/all_recipes.csv")
```

In the analyses we will focus on the following variables:
- *avg_rating*: Average user rating of a recipe
- *calories*: Caloric content of the recipe
- *total_time*: Total preparation time
- *protein, fat, carbs*: Macronutrient information

```{r}
all_recipes_c <- all_recipes_o %>%
select(name, avg_rating, calories, total_time, protein, fat, carbs) %>%
drop_na()
head(all_recipes_c)
summary(all_recipes_c)

all_recipes_c <- all_recipes_c %>%
  filter(calories <= 2000)
```

## Exploratory data analysis

First, we examine the distribution of caloric content across recipes.

```{r}
ggplot(all_recipes_c, aes(x = calories)) +
  geom_histogram(bins = 60) +
  labs(title = "Distribution of Recipe Calories", x = "Calories", y = "Count")
```

Then, we examine the distribution of caloric content across recipes.

```{r}
ggplot(all_recipes_c, aes(x = avg_rating)) +
  geom_histogram(bins = 20) +
  labs(title = "Distribution of Average Recipe Ratings", x = "Average Rating", y = "Count")
```

To explore the relationship between calories and ratings, we create a scatter plot with a fitted linear trend.

```{r}
ggplot(all_recipes_c, aes(x = avg_rating, y = calories)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = "lm") +
  labs(title = "Calories and average rating", x = "Average rating", y = "Calories")
```

## Statistical modeling
### Simple linear regression
To test the hypothesis that caloric content is associated with average ratings, we fit a simple linear regression model with average rating as the outcome variable and calories as the predictor.

```{r}
model_simple <- lm(avg_rating ~ calories, data = all_recipes_c)
summary(model_simple)
```

### Multiple linear regression
To account for potential confounding variables, we also fit a multiple linear regression model including preparation time and macronutrient content as additional predictors.

```{r}
model_multiple <- lm(avg_rating ~ calories + total_time + protein + fat + carbs,
data = all_recipes_c)
summary(model_multiple)
```

## Model diagnostics
To assess whether the assumptions of linear regression are met, we examine standard diagnostic plots for the multiple regression model. The diagnostic plots are used to evaluate linearity, homoscedasticity, normality of residuals, and the presence of influential observations.

```{r}
par(mfrow = c(2, 2))
plot(model_multiple)
```